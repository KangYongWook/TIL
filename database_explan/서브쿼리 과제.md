- 내가 속한 부서가 각 부서 별 월급 평균 보다 이상으로 받는 직원들을 조회 하시오.

```sql
SELECT ENAME, SAL FROM EMP e1
WHERE SAL > (
SELECT AVG(SAL) FROM EMP e2
WHERE e1.DEPTNO = e2.DEPTNO
GROUP BY DEPTNO
)


```

- 내가 속한 각 부서 별 월급이 가장 많이 받는 직원들을 조회하시오. 
  단 부서명과 지역을 출력 하시오.

```sql
SELECT e.ENAME,e.SAL, d.DNAME , d.LOC FROM 
EMP e, DEPT d

WHERE e.DEPTNO = d.DEPTNO

SELECT e1.DEPTNO,e1.ENAME, e1.SAL,
d.DNAME,d.LOC
FROM EMP e1, DEPT d
WHERE e1.DEPTNO = d.DEPTNO
AND SAL >= (
SELECT MAX(SAL) FROM EMP e2
WHERE e1.DEPTNO = e2.DEPTNO
GROUP BY DEPTNO
)
```



- SCOTT이 소속된 부서의 직원 정보를 조회 하시오

```sql
SELECT e1.DEPTNO,e1.ENAME, e1.SAL,d.DNAME,d.LOC
FROM EMP e1, DEPT d
WHERE e1.DEPTNO = d.DEPTNO
AND e.DEPTNO IN  (
SELECT DEPTNO FROM EMP 
WHERE ENAME = 'SCOTT'
)
```



- DALLAS에 있는 직원의 정보를 조회 하시오.

```sql
SELECT e1.DEPTNO,e1.ENAME, e1.SAL,d.DNAME,d.LOC
FROM EMP e1, DEPT d
WHERE e1.DEPTNO = d.DEPTNO
AND EXISTS(
SELECT d2.DEPTNO FROM DEPT d2, EMP e2
WHERE d2.DEPTNO = e2.DEPTNO
AND LOC = 'DALLAS'
AND e1.DEPTNO = e2.DEPTNO
)
```



- JONES가 속한 JOB의 직원을 조회 하시오

```sql


SELECT ENAME, JOB FROM EMP
WHERE JOB IN(
 SELECT JOB FROM EMP
WHERE ENAME = 'JONES'
)

SELECT ENAME, JOB FROM EMP e1
WHERE EXISTS(
 SELECT JOB FROM EMP e2
WHERE ENAME = 'JONES'
AND e1.JOB = e2.JOB
)
```



- JONES가 속한 JOB의 직원을 조회 하시오
  단 직원의 부서명과 지역을 출력 하시오.

```sql
SELECT * FROM EMP
SELECT * FROM DEPT
SELECT e.ENAME, e.JOB,d.DNAME, d.LOC  FROM EMP e, DEPT,d
WHERE EXISTS(
 SELECT JOB FROM EMP E2
WHERE ENAME = 'JONES'
AND e.JOB = E2.JOB
)
```



- MANAGER 와 SALES 직원들의 이름과 JOB을 조회 하시오

```sql
SELECT ENAME, JOB FROM EMP
WHERE JOB = 'MANAGER'
UNION
SELECT ENAME, JOB FROM EMP
WHERE JOB = 'SALESMAN'
ORDER BY JOB

SELECT ENAME, JOB FROM EMP
WHERE JOB = 'MANAGER'
UNION
SELECT ENAME, TO_CHAR(HIREDATE,'YYYY/MM/DD') FROM EMP
WHERE JOB = 'SALESMAN'

ORDER BY JOB

SELECT E.ENAME , D.LOC FROM 
EMP E, DEPT D
WHERE E.DEPTNO = D.DEPTNO
AND E.JOB = 'MANAGER'
AND D.LOC = 'CHICAGO'

SELECT E.ENAME , D.LOC FROM 
EMP E INNER JOIN DEPT D 
ON (E.DEPTNO = D.DEPTNO)
WHERE E.JOB = 'MANAGER'
AND D.LOC = 'CHICAGO'


```

------

- VIEW

```sql
CREATE VIEW T_EMP(ENO,ENM,SAL,DNO)
AS (
  SELECT EMPNO , ENAME , SAL, DEPTNO  FROM EMP
)

CREATE VIEW T_DEPT(DNO,DNM,LOC)
AS(
  SELECT DEPTNO, DNAME, LOC FROM DEPT
)
```

------



- T_SAL 직원 ENO, ASAL(연봉)

```sql
CREATE VIEW T_SAL (ENO,ASAL)
AS (
   SELECT EMPNO, (SAL*12)+ (NVL(COMM,0)*12) FROM EMP
)
```



- 직원 정보를 조회 하시오
  ENO, ENM , SAL, ASAL, DNM , LOC
  JONES 부서원만 조회 하시오

```sql
SELECT E.ENO, E.ENM, A.ASAL, D.DNM, D.LOC 
FROM T_EMP E , T_SAL A, T_DEPT D 
WHERE E.DNO = D.DNO
AND E.ENO = A.ENO
AND E.DNO IN (
SELECT DNO FROM T_EMP WHERE ENM= 'JONES'
)

--표준문
SELECT E.ENO, E.ENM, A.ASAL, D.DNM, D.LOC 
FROM T_EMP E INNER JOIN T_DEPT D ON(E.DNO = D.DNO)
INNER JOIN T_SAL A ON (E.ENO= A.ENO) 
```





- 직원 정보를 조회 하시오
  ENO, ENM , SAL, ASAL, DNM , LOC
  JONES 부서원만 조회 하시오
  부서별 연봉의 평균 보다 많이 받는 직원을 조회



```sql
SELECT E.ENO, E.ENM, A.ASAL, D.DNM, D.LOC 
FROM T_EMP E , T_SAL A, T_DEPT D 
WHERE E.DNO = D.DNO
AND E.ENO = A.ENO
AND A.ASAL >=(
SELECT AVG(S1.ASAL)
FROM T_EMP E1, T_SAL S1
WHERE E1.ENO = S1.ENO
AND E.DNO = E1.DNO
GROUP BY (E1.DNO)
)

SELECT E1.EMPNO AS EMPNO,
       E1.ENAME AS ENAME,
       E2.ENAME AS MNAME
FROM EMP E1, EMP E2
WHERE E1.MGR = E2.MGR

INSERT INTO EMP VALUES
(8888,'KSK','SALESMAN',7839,
TO_DATE('2019/06/01','YYYY/MM/DD'),4000,100,NULL)

SELECT JOB, AVG(SAL),SUM(SAL) FROM EMP
GROUP BY  ROLLUP(JOB)


```



